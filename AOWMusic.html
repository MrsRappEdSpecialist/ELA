<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AoW: Stress Less, Listen More</title>
    <style>
        :root {
            --bg: #0d0e15; --panel: #1a1c29; --text: #e2e8f0; --muted: #a0aec0;
            --cyan: #00f3ff; --purple: #bc13fe; --pink: #ff007f; --hl: #ffea00;
            --font: 'Segoe UI', Roboto, sans-serif;
        }
        /* Accessibility Classes */
        body.high-contrast { --bg: #000; --panel: #000; --text: #fff; --cyan: #fff; --purple: #fff; --pink: #fff; }
        body.dyslexia { --font: 'Comic Sans MS', sans-serif !important; }

        body { background: var(--bg); color: var(--text); font-family: var(--font); margin: 0; line-height: 1.8; transition: 0.3s; overflow-x: hidden; }
        
        #progress-container { position: fixed; top: 0; left: 0; width: 100%; height: 6px; background: rgba(255,255,255,0.1); z-index: 20001; }
        #progress-bar { height: 100%; width: 0%; background: linear-gradient(90deg, var(--cyan), var(--purple)); }
        
        #reading-ruler { display: none; position: fixed; left: 0; width: 100%; height: 35px; background: rgba(0,243,255,0.1); border-top: 1px solid var(--cyan); border-bottom: 1px solid var(--cyan); pointer-events: none; z-index: 15000; }

        .container { max-width: 1100px; margin: 60px auto; background: var(--panel); padding: 40px; border-radius: 12px; border: 1px solid rgba(0,243,255,0.1); position: relative; }
        
        .access-panel { display: flex; flex-wrap: wrap; gap: 10px; background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; margin-bottom: 30px; border: 1px dashed var(--cyan); }
        .btn-acc { background: transparent; color: var(--text); border: 1px solid var(--purple); padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 0.9rem; }
        .btn-acc:hover { background: var(--purple); }

        .header-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 30px; }
        .header-grid input { background: transparent; border: none; border-bottom: 2px solid var(--cyan); color: #fff; padding: 5px; outline: none; font-size: 1rem; }

        h1 { color: var(--cyan); border-left: 5px solid var(--cyan); padding-left: 15px; text-transform: uppercase; }

        /* Article Structure */
        .article-row { display: grid; grid-template-columns: 2fr 1fr; gap: 30px; margin-bottom: 40px; align-items: start; }
        .p-num { color: var(--pink); font-weight: bold; margin-right: 10px; font-family: monospace; }
        
        textarea { width: 100%; background: #fff; color: #000; border: 2px solid var(--purple); border-radius: 6px; padding: 12px; font-family: inherit; font-size: 1rem; resize: none; overflow: hidden; min-height: 45px; transition: 0.2s; }
        textarea:focus { border-color: var(--cyan); box-shadow: 0 0 10px rgba(0,243,255,0.3); outline: none; }

        img { width: 100%; height: 350px; object-fit: cover; border: 2px solid var(--cyan); border-radius: 8px; margin: 20px 0; }

        /* Interaction Elements */
        .hl-popup { display: none; position: absolute; background: var(--hl); color: #000; padding: 5px 12px; border-radius: 20px; font-weight: bold; cursor: pointer; z-index: 10000; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        .highlight { background: var(--hl); color: #000; cursor: pointer; border-radius: 3px; }
        
        .tts-btn { background: transparent; border: 1px solid var(--pink); color: var(--pink); border-radius: 4px; cursor: pointer; padding: 2px 8px; margin-right: 10px; }
        
        .embedded-box { background: rgba(0,243,255,0.05); border: 1px solid var(--cyan); padding: 20px; border-radius: 8px; margin: 20px 0; }
        .hint-lvl { display: none; background: rgba(255,0,127,0.1); border-left: 4px solid var(--pink); padding: 10px; margin: 10px 0; font-size: 0.9rem; }
        
        .feedback { display: none; margin-top: 10px; padding: 10px; border-radius: 4px; font-weight: bold; font-size: 0.9rem; }

        #lock-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); z-index: 20000; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        
        /* Print Specifics */
        .print-box { display: none; white-space: pre-wrap; color: #000; background: #fff; border: 1px solid #000; padding: 15px; margin-top: 5px; }
        @media print {
            body { background: #fff !important; color: #000 !important; }
            .container { width: 100% !important; border: none !important; box-shadow: none !important; margin: 0 !important; }
            textarea, .access-panel, .hl-popup, #lock-screen, #progress-container, .btn-acc, button { display: none !important; }
            .print-box { display: block !important; }
            .article-row { grid-template-columns: 2fr 1fr !important; gap: 20px !important; }
        }
    </style>
</head>
<body>

<div id="lock-screen">
    <h1 style="border:none;">Access Locked</h1>
    <p style="color:var(--muted)">Enter Passcode: EnglishAow</p>
    <input type="password" id="pass-input" style="padding:15px; border-radius:8px; border:2px solid var(--purple); text-align:center; font-size:1.2rem; background:#000; color:#fff;">
    <button class="btn-acc" style="margin-top:20px; padding:10px 30px;" onclick="unlock()">Unlock</button>
</div>

<div id="progress-container"><div id="progress-bar"></div></div>
<div id="reading-ruler"></div>
<div id="hl-menu" class="hl-popup" onclick="doHighlight()">Highlight</div>

<div class="container" id="assignment-body">
    <div class="access-panel">
        <button class="btn-acc" onclick="fontSize(-2)">A-</button>
        <button class="btn-acc" onclick="fontSize(2)">A+</button>
        <button class="btn-acc" onclick="document.body.classList.toggle('dyslexia')">Dyslexia Font</button>
        <button class="btn-acc" onclick="document.body.classList.toggle('high-contrast')">High Contrast</button>
        <button class="btn-acc" onclick="toggleRuler()">Reading Ruler</button>
    </div>

    <div class="header-grid">
        <div>Name: <input type="text" id="name" class="save-me"></div>
        <div>Period: <input type="text" id="period" class="save-me" size="4"></div>
        <div>Date: <span id="auto-date"></span></div>
    </div>

    <h1>Article of the Week: Stress Less, Listen More</h1>
    <p style="color:var(--muted)">Standards: RI.9-10.1, RI.9-10.4, W.9-10.1</p>

    <div class="embedded-box">
        <h3>Pre-reading Engagement</h3>
        <p>Before reading, reflect: When you are stressed, do you use music to cope? Why or why not?</p>
        <textarea id="pre-read" class="save-me auto-grow"></textarea>
    </div>

    <div class="article-row">
        <div class="article-text">
            <p><button class="tts-btn" onclick="read(this)">üîä</button><span class="p-num">[1]</span> At any given moment when you press play on your favorite song, your body might already be starting to relax. Music is more than just entertainment, it can actually lower our stress levels.</p>
            <img src="https://images.unsplash.com/photo-1508700115892-45ecd05ae2ad?w=900&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTl8fG11c2ljfGVufDB8fDB8fHww" alt="Concert Stage">
            <p><button class="tts-btn" onclick="read(this)">üîä</button><span class="p-num">[2]</span> In a world where stress has become a part of the daily life for students, workers, and family, something as accessible as music could be one of the most powerful tools to help manage it.</p>
            <p><button class="tts-btn" onclick="read(this)">üîä</button><span class="p-num">[3]</span> Stress has become increasingly common in our everyday routines. With academic pressure and the rise of social media, many people experience mental health issues.</p>
        </div>
        <textarea id="t4-1" class="save-me auto-grow" placeholder="T4 Annotations..."></textarea>
    </div>

    <div class="article-row">
        <div class="article-text">
            <p><button class="tts-btn" onclick="read(this)">üîä</button><span class="p-num">[4]</span> According to ANA (American Nurses Association), ‚ÄúWhen you <strong>incorporate</strong> more music into your life, it can help relieve anxiety, provide an emotional release, help you focus on the present moment, pull away from stressors, encourage creativity, and increase connection.‚Äù</p>
            
            <div class="embedded-box">
                <h4>Vocabulary Check</h4>
                <p>Based on context, what is the best definition for "incorporate"?</p>
                <button class="btn-acc" onclick="vocab(this, true)">To integrate or combine into a whole</button>
                <button class="btn-acc" onclick="vocab(this, false)">To isolate or separate parts</button>
                <div class="feedback"></div>
            </div>

            <p><button class="tts-btn" onclick="read(this)">üîä</button><span class="p-num">[5]</span> Not only does music improve our mental health, but it also allows us to build strong connections with others who find similar music taste, therefore causing stronger bonds and relations thanks to music.</p>
        </div>
        <textarea id="t4-2" class="save-me auto-grow" placeholder="T4 Annotations..."></textarea>
    </div>

    <div class="article-row">
        <div class="article-text">
            <p><button class="tts-btn" onclick="read(this)">üîä</button><span class="p-num">[6]</span> Music has also been proven to help patients with dementia to remember certain aspects about their earlier lives.</p>
            <img src="https://images.unsplash.com/photo-1514320291840-2e0a9bf2a9ae?w=900&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTV8fG11c2ljfGVufDB8fDB8fHww">
            
            <div class="embedded-box">
                <h4>5Cs: Critical Thinking</h4>
                <p>How does music create a "Connection" between people, according to the text?</p>
                <button class="btn-acc" onclick="showHint('5c')">Need a Hint?</button>
                <div id="hint-5c-1" class="hint-lvl">Level 1: Look at paragraph 5. What happens when people share a music taste?</div>
                <div id="hint-5c-2" class="hint-lvl">Level 2: Start with: "Shared music builds connections by..."</div>
                <textarea id="5c-ans" class="save-me auto-grow" style="margin-top:10px;"></textarea>
            </div>

            <p><button class="tts-btn" onclick="read(this)">üîä</button><span class="p-num">[7]</span> Another benefit is how music helps emotionally. It can serve as a healthy outlet to process our feelings when feeling anxious, overwhelmed, or even just mentally drained.</p>
            <p><button class="tts-btn" onclick="read(this)">üîä</button><span class="p-num">[8]</span> After polling 118 people, 116 said that music does help improve our mental health... This means that 98% of people found music to be relieving.</p>
        </div>
        <textarea id="t4-3" class="save-me auto-grow" placeholder="T4 Annotations..."></textarea>
    </div>

    <div class="embedded-box">
        <h2>Claim-Evidence-Reasoning (CER)</h2>
        <p>Prompt: Is music an essential tool for student stress management? Support your claim with evidence from the poll in paragraph 8.</p>
        <button class="btn-acc" onclick="showHint('cer')">CER Hints</button>
        <div id="hint-cer-1" class="hint-lvl">Level 1: Your claim should answer the question directly.</div>
        <div id="hint-cer-2" class="hint-lvl">Level 2: Evidence: "According to the poll of 118 people, 98% said..."</div>
        <textarea id="cer-resp" class="save-me auto-grow" style="min-height:150px;"></textarea>
    </div>

    <div style="text-align:center; padding: 40px;">
        <button class="btn-acc" style="font-size:1.5rem; padding: 20px 50px; border-color:var(--cyan); color:var(--cyan);" onclick="exportPDF()">üì• Final Submit (Save as PDF)</button>
    </div>
</div>

<script>
    // --- SECURITY ---
    function unlock() {
        if(document.getElementById('pass-input').value.toLowerCase() === "englishaow") {
            document.getElementById('lock-screen').style.display = 'none';
            document.body.style.overflow = "auto";
        }
    }
    document.body.style.overflow = "hidden";
    document.getElementById('auto-date').innerText = new Date().toLocaleDateString();

    // --- ANNOTATIONS (Highlighter) ---
    function handleSelection() {
        let sel = window.getSelection();
        let menu = document.getElementById('hl-menu');
        if (sel.toString().length > 0) {
            let range = sel.getRangeAt(0).getBoundingClientRect();
            menu.style.display = 'block';
            menu.style.left = (range.left + window.scrollX) + 'px';
            menu.style.top = (range.top + window.scrollY - 40) + 'px';
        } else { menu.style.display = 'none'; }
    }
    document.onmouseup = handleSelection;

    function doHighlight() {
        let sel = window.getSelection();
        if (sel.rangeCount) {
            let range = sel.getRangeAt(0);
            let span = document.createElement("span");
            span.className = "highlight";
            span.onclick = function() { this.replaceWith(...this.childNodes); save(); };
            range.surroundContents(span);
            save();
        }
    }

    // Double-click to define
    document.addEventListener('dblclick', (e) => {
        let word = window.getSelection().toString().trim();
        if(word) alert("Context Check: '" + word + "'\n\nUse context clues to find the meaning or double-check with a dictionary.");
    });

    // --- ACCESSIBILITY ---
    let synth = window.speechSynthesis;
    function read(btn) {
        if(synth.speaking) { synth.cancel(); if(btn.innerText === '‚èπÔ∏è') { btn.innerText = 'üîä'; return; } }
        document.querySelectorAll('.tts-btn').forEach(b => b.innerText = 'üîä');
        let txt = btn.parentElement.innerText.replace('üîä','');
        let utter = new SpeechSynthesisUtterance(txt);
        utter.onend = () => btn.innerText = 'üîä';
        btn.innerText = '‚èπÔ∏è';
        synth.speak(utter);
    }

    let rulerOn = false;
    function toggleRuler() { rulerOn = !rulerOn; document.getElementById('reading-ruler').style.display = rulerOn ? 'block' : 'none'; }
    document.addEventListener('mousemove', e => { if(rulerOn) document.getElementById('reading-ruler').style.top = (e.clientY - 15) + 'px'; });

    function fontSize(v) { let s = parseInt(window.getComputedStyle(document.body).fontSize); document.body.style.fontSize = (s + v) + 'px'; }

    // --- PROGRESS BAR ---
    window.onscroll = () => {
        let winScroll = document.documentElement.scrollTop;
        let height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
        document.getElementById("progress-bar").style.width = (winScroll / height * 100) + "%";
    };

    // --- LOGIC (Hints/Vocab) ---
    const hintStates = {};
    function showHint(id) {
        hintStates[id] = (hintStates[id] || 0) + 1;
        let h = document.getElementById('hint-' + id + '-' + hintStates[id]);
        if(h) h.style.display = 'block';
    }

    function vocab(btn, correct) {
        let f = btn.parentElement.querySelector('.feedback');
        f.style.display = 'block';
        f.style.color = correct ? "#00ff00" : "#ff3333";
        f.innerText = correct ? "Correct! Incorporate means to blend into a single whole." : "Incorrect. Try looking at how music is 'added' to life in para 4.";
    }

    // --- DATA & PDF ---
    function save() {
        const data = {};
        document.querySelectorAll('.save-me').forEach(el => data[el.id] = el.value);
        data['html'] = document.getElementById('assignment-body').innerHTML;
        localStorage.setItem('aow_data_music', JSON.stringify(data));
    }

    document.querySelectorAll('.auto-grow').forEach(ta => {
        ta.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = (this.scrollHeight) + 'px';
            save();
        });
    });

    window.onload = () => {
        const d = JSON.parse(localStorage.getItem('aow_data_music'));
        if(d) {
            Object.keys(d).forEach(k => {
                let el = document.getElementById(k);
                if(el && k !== 'html') { el.value = d[k]; el.dispatchEvent(new Event('input')); }
            });
            // Highlights restoration is complex with innerHTML, usually handled via ranges, but for local use innerHTML can be restored if container is static.
        }
    };

    function exportPDF() {
        document.querySelectorAll('textarea').forEach(ta => {
            let g = document.createElement('div');
            g.className = 'print-box';
            g.innerText = ta.value || "[No Student Response]";
            ta.parentNode.insertBefore(g, ta.nextSibling);
        });
        setTimeout(() => { window.print(); }, 300);
    }
    window.addEventListener('afterprint', () => document.querySelectorAll('.print-box').forEach(el => el.remove()));
</script>
</body>
</html>
